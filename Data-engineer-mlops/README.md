# Introduction au Data Engineering  

## Objectifs p√©dagogiques

√Ä la fin de cette partie, vous serez capables de :

- Comprendre pourquoi la donn√©e est strat√©gique aujourd‚Äôhui  
- Identifier les principaux m√©tiers de la data  
- D√©finir ce qu‚Äôest le Data Engineering  
- Comprendre le r√¥le du Data Engineer dans une organisation  

# 1. Pourquoi la donn√©e est strat√©gique aujourd‚Äôhui

## 1.1 Une r√©volution num√©rique

Nous vivons dans une √©conomie o√π presque toutes les activit√©s g√©n√®rent des donn√©es :

- Achats en ligne  
- Utilisation d‚Äôapplications mobiles  
- R√©seaux sociaux  
- Paiements par carte  
- Capteurs industriels  
- Objets connect√©s  

Chaque interaction num√©rique produit une trace exploitable.

La quantit√© de donn√©es g√©n√©r√©e mondialement augmente de mani√®re exponentielle. Cette explosion cr√©e une opportunit√© majeure : transformer ces donn√©es en information utile.

## 1.2 La donn√©e comme actif strat√©gique

La donn√©e est devenue un actif au m√™me titre que :

- Les ressources humaines  
- Les √©quipements  
- La propri√©t√© intellectuelle  

Les entreprises performantes utilisent la donn√©e pour :

- Comprendre leurs clients  
- Optimiser leurs op√©rations  
- R√©duire leurs co√ªts  
- Am√©liorer leurs produits  
- Prendre des d√©cisions plus rapides  

* **Exemple :**  
Une entreprise e-commerce peut analyser :

- Les produits les plus vendus  
- Les heures de forte activit√©  
- Les taux d‚Äôabandon de panier  
- L‚Äôefficacit√© des campagnes marketing  

Ces analyses permettent d‚Äôaugmenter le chiffre d‚Äôaffaires et d‚Äôam√©liorer l‚Äôexp√©rience client.

## 1.3 D√©cisions bas√©es sur les donn√©es

On parle de **data-driven decision making** :  

> Prendre des d√©cisions bas√©es sur des faits mesurables plut√¥t que sur l‚Äôintuition.

* **Exemples :**

- Ajuster les prix en fonction de la demande  
- Anticiper les ruptures de stock  
- D√©tecter des fraudes bancaires  
- Personnaliser des recommandations  

La donn√©e permet de passer d‚Äôune logique r√©active √† une logique proactive.


# 2. Les principaux m√©tiers de la Data

La valorisation des donn√©es repose sur plusieurs r√¥les compl√©mentaires.

## 2.1 Le Data Analyst : <img src="images/da.png" alt="Cute Dog" width="100" height="100">  


Mission principale :

- Explorer les donn√©es
- Produire des rapports
- Cr√©er des tableaux de bord
- Identifier des tendances

**Outils typiques :**

- SQL  
- Excel  
- Power BI / Tableau  

Le Data Analyst r√©pond √† la question :

> Que s‚Äôest-il pass√© ?

Il transforme les donn√©es en informations compr√©hensibles pour le m√©tier.

## 2.2 Le Data Scientist: <img src="images/ds.png" alt="Cute Dog" width="100" height="100">  

**Mission principale :**

- Construire des mod√®les pr√©dictifs
- Appliquer des techniques de Machine Learning
- Automatiser des pr√©dictions

**Exemples :**

- Pr√©dire les ventes  
- D√©tecter la fraude  
- Recommander des produits  

Le Data Scientist r√©pond √† la question :

> Que va-t-il se passer ?

Il utilise des mod√®les math√©matiques pour anticiper.

## 2.3 Le Data Engineer: <img src="images/de.png" alt="Cute Dog" width="100" height="100">  

Mission principale :

- Construire et maintenir l‚Äôinfrastructure de donn√©es
- Assurer la qualit√© et la disponibilit√© des donn√©es
- Optimiser les flux de donn√©es

Le Data Engineer r√©pond √† la question :

> Comment rendre la donn√©e fiable et exploitable ?

Sans lui :

- Les donn√©es sont dispers√©es  
- Les analyses sont incorrectes  
- Les mod√®les sont inefficaces  

Il est le socle technique de l‚Äô√©cosyst√®me data.

# 3. D√©finition du Data Engineering

## 3.1 D√©finition simple

Le Data Engineering consiste √† :

> Concevoir, d√©velopper et maintenir les syst√®mes permettant de collecter, transformer et stocker les donn√©es afin qu‚Äôelles puissent √™tre utilis√©es par l‚Äôentreprise.

## 3.2 Les grandes missions

### 1. Collecte (Ingestion)

R√©cup√©rer les donn√©es depuis :

- Bases de donn√©es
- Fichiers
- APIs
- Applications
- Syst√®mes m√©tiers

### 2. Transformation

Pr√©parer les donn√©es :

- Nettoyage
- Suppression des doublons
- Standardisation des formats
- Calcul d‚Äôindicateurs

### 3. Stockage

Organiser les donn√©es dans des syst√®mes adapt√©s :

- Data Warehouse
- Data Lake
- Bases analytiques

### 4. Mise √† disposition

Permettre aux utilisateurs de :

- Lancer des requ√™tes
- Cr√©er des dashboards
- Entra√Æner des mod√®les

# 4. R√¥le du Data Engineer dans une organisation

## 4.1 Positionnement

Le Data Engineer travaille √† l‚Äôintersection de :

- L‚ÄôIT  
- Les √©quipes m√©tier  
- Les Data Analysts  
- Les Data Scientists  

Il assure la circulation fiable de l‚Äôinformation.

## 4.2 Exemple concret : entreprise e-commerce

Sources de donn√©es :

- Commandes clients  
- Paiements  
- Donn√©es produits  
- Donn√©es marketing  
- Logs du site  

Le Data Engineer :

1. Centralise ces donn√©es  
2. Les nettoie  
3. Les structure  
4. Les stocke dans un Data Warehouse  
5. Garantit leur qualit√©  

Ensuite :

- L‚Äô√©quipe marketing analyse les performances  
- Le d√©partement finance suit les revenus  
- Les Data Scientists d√©veloppent des mod√®les  

## 4.3 Impact strat√©gique

Un bon Data Engineering permet :

- Des d√©cisions rapides  
- Des indicateurs fiables  
- Une meilleure collaboration entre √©quipes  
- Une capacit√© √† g√©rer la croissance  

Un mauvais pipeline data entra√Æne :

- Des erreurs d‚Äôanalyse  
- Des pertes financi√®res  
- Une perte de confiance dans les donn√©es  

# 5. Synth√®se

- La donn√©e est un actif strat√©gique majeur.  
- Les entreprises modernes s‚Äôappuient sur la donn√©e pour d√©cider.  
- Plusieurs m√©tiers interviennent dans la cha√Æne de valeur data.  
- Le Data Engineer construit l‚Äôinfrastructure qui rend tout cela possible.  
- Il joue un r√¥le central dans la fiabilit√© et la performance des syst√®mes data.  


# 6. D√©couvrez Snowflake avec les notebooks : 

Snowflake Notebooks est une interface de d√©veloppement unifi√©e dans l‚ÄùSnowsight qui offre un environnement de programmation interactif, bas√© sur des cellules, pour Python, SQL et Markdown. Dans Notebooks, vous pouvez exploiter vos donn√©es Snowflake pour effectuer des analyses de donn√©es exploratoires, d√©velopper des mod√®les de machine learning et ex√©cuter d‚Äôautres workflows de science et d‚Äôing√©nierie des donn√©es, le tout dans la m√™me interface.

* Explorez et exp√©rimentez les donn√©es d√©j√† pr√©sentes dans Snowflake, ou chargez de nouvelles donn√©es dans Snowflake.

* √âcrivez du code SQL ou Python et comparez rapidement les r√©sultats avec le d√©veloppement et l‚Äôex√©cution cellule par cellule.

* Visualisez vos donn√©es de mani√®re interactive √† l‚Äôaide de visualisations Streamlit int√©gr√©es et d‚Äôautres biblioth√®ques comme Altair, Matplotlib ou seaborn.

* Int√©grez Git pour collaborer avec un outil de contr√¥le des versions efficace.

* Contextualisez les r√©sultats et prenez des notes sur les diff√©rents r√©sultats √† l‚Äôaide de cellules et de graphiques Markdown.

* Ex√©cutez votre notebook selon une planification pour automatiser les pipelines

![alt text](images/notebooke.png)

La barre d‚Äôoutils Snowflake Notebooks pr√©sente les commandes utilis√©es pour g√©rer le notebook et ajuster les param√®tres d‚Äôaffichage des cellules.

* **Package selector** : s√©lectionner et installer les paquets √† utiliser dans le notebook. Voir Importer des paquets Python √† utiliser dans les notebooks.
	
* **Start** : D√©marrer la session Notebooks. Au d√©marrage de la session, l‚Äôimage devient Active.

* **Active** : survolez le bouton pour voir en temps r√©el les d√©tails de la session et les mesures de consommation des ressources agr√©g√©es (les mesures d‚Äôutilisation de la m√©moire et des CPU/GPU sont affich√©es pour les notebooks Container Runtime). S√©lectionnez la fl√®che vers le bas pour acc√©der aux options permettant de red√©marrer ou de terminer la session. S√©lectionnez Active pour mettre fin √† la session en cours.

* **Run All/Stop** : Ex√©cuter toutes les cellules ou arr√™ter l‚Äôex√©cution des cellules. Voir Ex√©cuter des cellules dans Snowflake Notebooks.
	
* **Scheduler** : D√©finir une planification pour ex√©cuter votre notebook en tant que t√¢che √† l‚Äôavenir. Voir Planifier des ex√©cutions de notebooks.

* **Vertical ellipsis menu** : Personnaliser les param√®tres du notebook, effacer les sorties de cellules, dupliquer, exporter ou supprimer le notebook.

### Exemple: Streamlit dans les notebooks

Streamlit est livr√© pr√©install√© avec l‚Äôenvironnement de Snowflake Notebooks. L‚Äôexemple de cette section cr√©e une application de donn√©es interactive √† l‚Äôaide de Streamlit.

1. Connectez-vous √† Snowsight (WebUI de Snowflake).

2. Dans le menu de navigation, s√©lectionnez **Projects** ¬ª **Notebooks**.

![alt text](images/notebooke2.png)

3. Ouvrez le notebook que vous souhaitez mettre √† jour.

4. S√©lectionnez le menu vertical indiqu√© par une ellipse (Plus d'actions pour la feuille de calcul) en haut √† droite de votre notebook.

5. S√©lectionnez **Notebook settings**.

![alt text](images/notebooke3.png)

6. S√©lectionnez le Runtime.

7. S√©lectionnez le param√®tre de d√©lai d‚Äôinactivit√© dans la liste d√©roulante.

8. Red√©marrez manuellement la session pour que le nouveau d√©lai d‚Äôinactivit√© prenne effet.

### 1. Importez les biblioth√®ques n√©cessaires

```
import streamlit as st
import pandas as pd
```
### 2.Cr√©ez d‚Äôabord quelques donn√©es d‚Äôexemple pour l‚Äôapplication.

```
species = ["setosa"] * 3 + ["versicolor"] * 3 + ["virginica"] * 3
measurements = ["sepal_length", "sepal_width", "petal_length"] * 3
values = [5.1, 3.5, 1.4, 6.2, 2.9, 4.3, 7.3, 3.0, 6.3]
df = pd.DataFrame({"species": species,"measurement": measurements,"value": values})
df
```

### 3.Installez votre curseur interactif √† partir de la biblioth√®que Streamlit.

```
st.markdown("""# Interactive Filtering with Streamlit! :balloon:
            Values will automatically cascade down the notebook cells""")
value = st.slider("Move the slider to change the filter value üëá", df.value.min(), df.value.max(), df.value.mean(), step = 0.3 )
```

### 4.Enfin, affichez une table filtr√©e en fonction de la valeur du curseur.
```
df[df["value"]>value].sort_values("value")
```
Vous pouvez interagir avec l‚Äôapplication en temps r√©el √† partir du notebook. Voyez la table filtr√©e changer en fonction de la valeur que vous avez d√©finie sur le curseur.

## Limitations de Notebooks

* Un seul fichier ipynb ex√©cutable est autoris√© dans chaque notebook.

* Les composants et widgets Streamlit tels que les valeurs de curseur ne conservent pas leur √©tat si vous actualisez la fen√™tre du navigateur, si vous ouvrez le notebook dans un nouvel onglet ou si vous fermez et rouvrez l‚Äôonglet actuel.

* Lorsque vous cr√©ez un notebook √† partir d‚Äôun d√©p√¥t, seul le notebook s√©lectionn√© est ex√©cutable. Tous les autres notebooks du d√©p√¥t peuvent √™tre s√©lectionn√©s et √©dit√©s, mais ils ne sont pas ex√©cutables.

Nous allons passer √† la partique: [lab01](lab01.md)


-------------------------------------------------------------------

# Introduction au Machine Learning  

# Objectifs du cours

√Ä la fin de ce cours, vous serez capables de :

- Comprendre ce qu‚Äôest le Machine Learning
- Diffencier IA, Machine Learning et Data Engineering
- Identifier les principaux types de probl√®mes en Machine Learning
- Comprendre le cycle de vie d‚Äôun projet ML
- Comprendre le lien entre donn√©es, Data Engineering et Machine Learning
- √ätre pr√™ts √† r√©aliser un lab simple dans Snowflake

# Plan du cours

1. Comprendre le Machine Learning  
2. Les grands types de Machine Learning  
3. Le cycle de vie d‚Äôun projet ML  
4. Le r√¥le des donn√©es et du Data Engineering  
5. Introduction au ML dans Snowflake  
6. Pr√©paration au lab pratique  

# Partie 1 ‚Äì Comprendre le Machine Learning

## 1.1 Intelligence Artificielle vs Machine Learning

### Intelligence Artificielle (IA)

L‚ÄôIA est un domaine large qui vise √† cr√©er des syst√®mes capables d‚Äôimiter certaines capacit√©s humaines :

![alt text](images/ai.png)

- Comprendre du texte
- Reconna√Ætre des images
- Prendre des d√©cisions
- R√©soudre des probl√®mes

### Machine Learning (ML)

Le Machine Learning est une sous-cat√©gorie de l‚ÄôIA.

D√©finition simple :

> Le Machine Learning permet √† un syst√®me d‚Äôapprendre automatiquement √† partir de donn√©es, sans √™tre programm√© avec des r√®gles fixes.

Au lieu d‚Äô√©crire des r√®gles manuelles, on donne des exemples au syst√®me.

## 1.2 Exemple simple

Probl√®me : pr√©dire si un email est un spam.

Approche classique (sans ML) :

- Si le mot "gratuit" appara√Æt ‚Üí spam
- Si le mot "promotion" appara√Æt ‚Üí spam

Probl√®me : trop rigide.

Approche Machine Learning :

- On fournit des milliers d‚Äôemails d√©j√† class√©s.
- Le mod√®le apprend les patterns automatiquement.
- Il peut g√©n√©raliser √† de nouveaux emails.

## 1.3 Pourquoi le Machine Learning est devenu important

Trois raisons principales :

1. Explosion des donn√©es
2. Puissance de calcul disponible dans le cloud
3. Outils accessibles (Python, Snowflake, etc.)

Les entreprises utilisent le ML pour :

- Recommandations (Netflix, Amazon)
- D√©tection de fraude
- Pr√©vision des ventes
- Segmentation clients

# Partie 2 ‚Äì Les grands types de Machine Learning

## 2.1 Supervised Learning (Apprentissage supervis√©)

Dans ce cas, on poss√®de des donn√©es avec une r√©ponse connue.

Exemple :

| Surface | Prix |
|---------|------|
| 50 m¬≤   | 150 000 ‚Ç¨ |
| 70 m¬≤   | 210 000 ‚Ç¨ |

On conna√Æt la variable cible (le prix). 
Le probl√©me se mod√©lise sous forme d'une √©quation F(X)= Y. X sont les variable et Y le resultat en sortie.  

Le mod√®le apprend la relation entre les variables d‚Äôentr√©e et la sortie.

### Deux types principaux

#### 1. R√©gression

- Sortie num√©rique
- Exemple : pr√©dire un prix

#### 2. Classification

- Sortie cat√©gorielle
- Exemple : spam / non spam
- Client qui va partir / rester

## 2.2 Unsupervised Learning (Apprentissage non supervis√©)

Ici, il n‚Äôy a pas de r√©ponse connue.

Le mod√®le cherche √† identifier des structures cach√©es.

Exemple :

- Segmenter des clients en groupes similaires
- Identifier des comportements inhabituels

## 2.3 Exemple concret ‚Äì E-commerce

Donn√©es disponibles :

- Nombre d‚Äôachats
- Montant total d√©pens√©
- Nombre de visites
- Anciennet√© du client

Objectif possible :

- Pr√©dire si le client va arr√™ter d‚Äôacheter (classification)
- Segmenter les clients (clustering)
- Pr√©dire le montant futur (r√©gression)

# Partie 3 ‚Äì Le cycle de vie d‚Äôun projet Machine Learning

## 3.1 √âtapes principales

Un projet ML suit g√©n√©ralement ces √©tapes :

1. D√©finition du probl√®me
2. Collecte des donn√©es
3. Nettoyage des donn√©es
4. Pr√©paration des variables (feature engineering)
5. Entra√Ænement du mod√®le
6. √âvaluation
7. D√©ploiement

## 3.2 Point cl√©

Dans la pratique :

> 70 √† 80 % du travail concerne les donn√©es (Data engineering).

Nettoyer, transformer et structurer les donn√©es est souvent plus long que l‚Äôentra√Ænement du mod√®le lui-m√™me.

C‚Äôest ici que le **Data Engineering** joue un r√¥le essentiel.

# Partie 4 ‚Äì Lien entre Data Engineering et Machine Learning

## 4.1 Pourquoi les donn√©es sont critiques

Un mod√®le ML d√©pend de :

- La qualit√© des donn√©es
- La coh√©rence des formats
- L‚Äôabsence d‚Äôerreurs majeures

Si les donn√©es sont mauvaises :

- Les pr√©dictions seront mauvaises.

## 4.2 R√¥le du Data Engineer dans un projet ML

Le Data Engineer :

- Centralise les donn√©es
- Les nettoie
- Les structure
- Les rend accessibles
- Garantit leur qualit√©

Sans Data Engineering solide :

- Les Data Scientists ne peuvent pas travailler efficacement.
- Les mod√®les ne peuvent pas √™tre mis en production.

# Partie 5 ‚Äì Machine Learning dans Snowflake

## 5.1 Pourquoi utiliser Snowflake ?

Snowflake est un Data Warehouse cloud.

Il permet :

- Stocker de grandes quantit√©s de donn√©es
- Ex√©cuter des requ√™tes SQL
- Effectuer des transformations
- Int√©grer du Machine Learning

## 5.2 O√π s‚Äôex√©cute le Machine Learning ?

Deux approches possibles :

1. Extraire les donn√©es vers Python (ex : pandas, scikit-learn)
2. Utiliser Snowpark pour ex√©cuter du code Python directement dans Snowflake

Dans ce cours, nous allons utiliser une approche simple compatible d√©butant.

## 5.3 Exemple simplifi√© de pipeline ML

1. Charger un dataset dans Snowflake
2. Explorer les donn√©es avec SQL et Python
3. Cr√©er une table pr√©par√©e
4. Utiliser Python pour entra√Æner un mod√®le simple
5. G√©ner des pr√©dictions

# Partie 6 ‚Äì M√©triques simples d‚Äô√©valuation

## 6.1 Accuracy

Pourcentage de bonnes pr√©dictions.

Exemple : Si le mod√®le pr√©dit correctement 90 cas sur 100 ‚Üí accuracy = 90 %.

## 6.2 Cas particulier : fraude

Si 95 % des transactions ne sont pas frauduleuses :

Un mod√®le qui pr√©dit toujours "non fraude" aura 95 % d‚Äôaccuracy.

Mais il est inutile.

C‚Äôest pourquoi d‚Äôautres m√©triques existent (pr√©cision, rappel).

## Pr√©cision (Precision)

La pr√©cision mesure :

> Parmi toutes les pr√©dictions positives faites par le mod√®le, combien sont r√©ellement correctes ?

Autrement dit :

Si le mod√®le dit "positif", √† quel point peut-on lui faire confiance ?

### Exemple ‚Äì D√©tection de fraude

Imaginons :

- Le mod√®le d√©tecte 20 transactions comme frauduleuses.
- En r√©alit√©, seulement 15 sont vraiment frauduleuses.

Pr√©cision = 15 / 20 = 75 %

Cela signifie que 25 % des alertes sont fausses.

Une pr√©cision √©lev√©e est importante lorsque les faux positifs sont co√ªteux  
(ex : bloquer un client l√©gitime).

## Rappel (Recall)

Le rappel mesure :

> Parmi tous les cas r√©ellement positifs, combien le mod√®le a-t-il r√©ussi √† d√©tecter ?

Autrement dit :

Le mod√®le rate-t-il beaucoup de cas importants ?

### Exemple ‚Äì D√©tection de fraude

Imaginons :

- Il y a en r√©alit√© 30 transactions frauduleuses.
- Le mod√®le en d√©tecte 15.

Rappel = 15 / 30 = 50 %

Cela signifie que le mod√®le laisse passer 50 % des fraudes.

Un rappel √©lev√© est important lorsque rater un cas est critique  
(ex : maladie grave, fraude, d√©faut de paiement).

## R√©sum√©

- **Accuracy** ‚Üí Globalement, combien de pr√©dictions sont correctes ?
- **Pr√©cision** ‚Üí Quand le mod√®le pr√©dit "positif", a-t-il raison ?
- **Rappel** ‚Üí Parmi les vrais cas positifs, combien ont √©t√© d√©tect√©s ?

Selon le probl√®me m√©tier, on privil√©giera parfois la pr√©cision, parfois le rappel.

# Partie 7 ‚Äì Pr√©paration au Lab

## 7.1 Ce que vous allez faire

Dans le lab Snowflake, vous allez :

- Explorer un dataset client
- Comprendre les colonnes
- Cr√©er une table pr√©par√©e
- Effectuer des transformations simples en SQL
- Entra√Æner un mod√®le simple en Python
- G√©n√©rer des pr√©dictions

## 7.2 Comp√©tences mobilis√©es

- SQL basique (SELECT, WHERE, GROUP BY)
- Python basique
- Compr√©hension des concepts ML

# Conclusion

Dans ce cours, vous avez appris :

- Ce qu‚Äôest le Machine Learning
- Les principaux types de probl√®mes
- Le cycle de vie d‚Äôun projet ML
- Le r√¥le central des donn√©es
- Le lien entre Data Engineering et ML
- Comment Snowflake peut servir de plateforme ML

Vous √™tes maintenant pr√™ts √† passer √† la pratique [lab06](lab06.md).


